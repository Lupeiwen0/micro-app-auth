{"version":3,"file":"index.es.js","sources":["../src/index.ts"],"sourcesContent":["export type Config = {\n  scope: \"userInfo\" | \"userLocation\" | \"address\" | \"record\" | \"album\" | \"camera\";\n};\n\nexport type ExecuteName =\n  | \"getUserInfo\"\n  | \"getLocation\"\n  | \"chooseAddress\"\n  | \"saveImageToPhotosAlbum\"\n  | \"saveVideoToPhotosAlbum\"\n  | \"chooseImage\"\n  | \"scanCode\"\n  | \"chooseVideo\";\n\nexport type ExecuteOptions = {\n  success?: (res: any) => void;\n  fail?: (err: any) => void;\n  complete?: (err: any) => void;\n  [key: string]: any;\n};\n\nclass CheckAuthClient {\n  private target: any;\n  private scopeCode: string;\n\n  constructor(config: Config, _target: any) {\n    this.target = _target;\n    this.scopeCode = `scope.${config.scope}`;\n  }\n\n  checkTargetAuth() {\n    return new Promise((resolve, reject) => {\n      this.target.getSetting({\n        success: (res) => {\n          const state = res.authSetting[this.scopeCode];\n          if (state || state === undefined) {\n            return resolve(true);\n          } else if (state === false) {\n            this.target.openSetting({\n              success: (response) => {\n                const backState = response.authSetting[this.scopeCode];\n                if (backState) {\n                  resolve(backState);\n                } else {\n                  reject(backState);\n                }\n              },\n            });\n          }\n        },\n        fail(err) {\n          reject({ type: \"getSetting fail\", err });\n        },\n      });\n    });\n  }\n\n  async execute(name: ExecuteName, options: ExecuteOptions) {\n    await this.checkTargetAuth();\n    this.target[name](options);\n  }\n}\n\nexport default CheckAuthClient;\n"],"names":["CheckAuthClient","config","_target","resolve","reject","res","state","response","backState","err","name","options"],"mappings":"AAqBA,MAAMA,EAAgB;AAAA,EAIpB,YAAYC,GAAgBC,GAAc;AACxC,SAAK,SAASA,GACT,KAAA,YAAY,SAASD,EAAO,KAAK;AAAA,EACxC;AAAA,EAEA,kBAAkB;AAChB,WAAO,IAAI,QAAQ,CAACE,GAASC,MAAW;AACtC,WAAK,OAAO,WAAW;AAAA,QACrB,SAAS,CAACC,MAAQ;AAChB,gBAAMC,IAAQD,EAAI,YAAY,KAAK,SAAS;AACxC,cAAAC,KAASA,MAAU;AACrB,mBAAOH,EAAQ,EAAI;AACrB,UAAWG,MAAU,MACnB,KAAK,OAAO,YAAY;AAAA,YACtB,SAAS,CAACC,MAAa;AACrB,oBAAMC,IAAYD,EAAS,YAAY,KAAK,SAAS;AACrD,cAAIC,IACFL,EAAQK,CAAS,IAEjBJ,EAAOI,CAAS;AAAA,YAEpB;AAAA,UAAA,CACD;AAAA,QAEL;AAAA,QACA,KAAKC,GAAK;AACR,UAAAL,EAAO,EAAE,MAAM,mBAAmB,KAAAK,EAAK,CAAA;AAAA,QACzC;AAAA,MAAA,CACD;AAAA,IAAA,CACF;AAAA,EACH;AAAA,EAEA,MAAM,QAAQC,GAAmBC,GAAyB;AACxD,UAAM,KAAK,mBACN,KAAA,OAAOD,CAAI,EAAEC,CAAO;AAAA,EAC3B;AACF;"}