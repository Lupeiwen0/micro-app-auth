{"version":3,"file":"index.umd.js","sources":["../src/index.ts"],"sourcesContent":["export type Config = {\n  scope: \"userInfo\" | \"userLocation\" | \"address\" | \"record\" | \"album\" | \"camera\";\n};\n\nexport type ExecuteName =\n  | \"getUserInfo\"\n  | \"getLocation\"\n  | \"chooseAddress\"\n  | \"saveImageToPhotosAlbum\"\n  | \"saveVideoToPhotosAlbum\"\n  | \"chooseImage\"\n  | \"scanCode\"\n  | \"chooseVideo\";\n\nexport type ExecuteOptions = {\n  success?: (res: any) => void;\n  fail?: (err: any) => void;\n  complete?: (err: any) => void;\n  [key: string]: any;\n};\n\nclass CheckAuthClient {\n  private target: any;\n  private scopeCode: string;\n\n  constructor(config: Config, _target: any) {\n    this.target = _target;\n    this.scopeCode = `scope.${config.scope}`;\n  }\n\n  checkTargetAuth() {\n    return new Promise((resolve, reject) => {\n      this.target.getSetting({\n        success: (res) => {\n          const state = res.authSetting[this.scopeCode];\n          if (state || state === undefined) {\n            return resolve(true);\n          } else if (state === false) {\n            this.target.openSetting({\n              success: (response) => {\n                const backState = response.authSetting[this.scopeCode];\n                if (backState) {\n                  resolve(backState);\n                } else {\n                  reject(backState);\n                }\n              },\n            });\n          }\n        },\n        fail(err) {\n          reject({ type: \"getSetting fail\", err });\n        },\n      });\n    });\n  }\n\n  async execute(name: ExecuteName, options: ExecuteOptions) {\n    await this.checkTargetAuth();\n    this.target[name](options);\n  }\n}\n\nexport default CheckAuthClient;\n"],"names":["CheckAuthClient","config","_target","resolve","reject","res","state","response","backState","err","name","options"],"mappings":"2NAqBA,MAAMA,CAAgB,CAIpB,YAAYC,EAAgBC,EAAc,CACxC,KAAK,OAASA,EACT,KAAA,UAAY,SAASD,EAAO,KAAK,EACxC,CAEA,iBAAkB,CAChB,OAAO,IAAI,QAAQ,CAACE,EAASC,IAAW,CACtC,KAAK,OAAO,WAAW,CACrB,QAAUC,GAAQ,CAChB,MAAMC,EAAQD,EAAI,YAAY,KAAK,SAAS,EACxC,GAAAC,GAASA,IAAU,OACrB,OAAOH,EAAQ,EAAI,EACVG,IAAU,IACnB,KAAK,OAAO,YAAY,CACtB,QAAUC,GAAa,CACrB,MAAMC,EAAYD,EAAS,YAAY,KAAK,SAAS,EACjDC,EACFL,EAAQK,CAAS,EAEjBJ,EAAOI,CAAS,CAEpB,CAAA,CACD,CAEL,EACA,KAAKC,EAAK,CACRL,EAAO,CAAE,KAAM,kBAAmB,IAAAK,CAAK,CAAA,CACzC,CAAA,CACD,CAAA,CACF,CACH,CAEA,MAAM,QAAQC,EAAmBC,EAAyB,CACxD,MAAM,KAAK,kBACN,KAAA,OAAOD,CAAI,EAAEC,CAAO,CAC3B,CACF"}